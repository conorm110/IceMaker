var fs = require('fs');

module.exports = function(sourcePath, destinationPath, callback) {
	var errs = null;
	var readStream = fs.createReadStream(sourcePath);
	var writeStream = fs.createWriteStream(destinationPath);

	function errorHandler(exception) {
		if (errs === null) errs = [];
		errs.push(exception);
	}

	readStream.on('error', errorHandler);
	writeStream.on('error', errorHandler);

	readStream.on('end', function() {
		readStream.destroy();
		writeStream.destroySoon();
		if (typeof callback =='function') {
			callback(errs);
		}
	});
	readStream.pipe(writeStream);
};